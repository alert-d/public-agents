{
  "description": "Query elevation data for a single coordinate pair",
  "type": "plan",
  "version": "v0.0.1",
  "serial": [
    {
      "description": "Get elevation data for the specified coordinates",
      "type": "fetch",
      "method": "GET",
      "url": "https://api.open-meteo.com/v1/elevation",
      "params": {
        "latitude": "39.7392",
        "longitude": "-104.9903"
      },
      "stream": true,
      "name": "elevationData",
      "testOutput": [
        "${ function($OUTPUT) { $test($OUTPUT.elevation, 'elevation data exists') } }",
        "${ function($OUTPUT) { $test($OUTPUT.elevation[0], 'elevation value exists') } }",
        "${ function($OUTPUT) { $test($OUTPUT.latitude, 'latitude exists in elevation data') } }",
        "${ function($OUTPUT) { $test($OUTPUT.longitude, 'longitude exists in elevation data') } }"
      ]
    },
    {
      "description": "Display elevation data in table format",
      "type": "table",
      "title": "Elevation Data",
      "stream": false,
      "name": "elevationTable",
      "input": "${[{\"latitude\": $elevationData.latitude[0], \"longitude\": $elevationData.longitude[0], \"elevation\": $elevationData.elevation[0]}]}",
      "testInput": [
        "${ function() { $test($elevationData.latitude[0], 'latitude available for table') } }",
        "${ function() { $test($elevationData.longitude[0], 'longitude available for table') } }",
        "${ function() { $test($elevationData.elevation[0], 'elevation data available for table') } }"
      ],
      "testOutput": [
        "${ function($OUTPUT) { $test($type($OUTPUT) = 'array', 'table output is array') } }",
        "${ function($OUTPUT) { $test($OUTPUT[0].latitude, 'latitude field exists in table output') } }",
        "${ function($OUTPUT) { $test($OUTPUT[0].longitude, 'longitude field exists in table output') } }",
        "${ function($OUTPUT) { $test($OUTPUT[0].elevation, 'elevation field exists in table output') } }"
      ]
    },
    {
      "description": "Analyze elevation data and provide insights",
      "model": "gpt-4",
      "type": "llm",
      "stream": true,
      "input": "${$elevationTable}",
      "query": "Based on the elevation data provided for coordinates 39.7392, -104.9903 (Denver, Colorado), give me a detailed analysis. Include: 1) The exact elevation in meters, 2) The significance of this elevation, 3) How this elevation might impact the local environment or climate.",
      "testInput": [
        "${ function() { $test($elevationTable~>$type() ='array', 'input to llm is an array') } }",
        "${ function() { $test($elevationTable[0].latitude, 'latitude field exists in llm input') } }",
        "${ function() { $test($elevationTable[0].longitude, 'longitude field exists in llm input') } }",
        "${ function() { $test($elevationTable[0].elevation, 'elevation field exists in llm input') } }"
      ]
    }
  ]
}
